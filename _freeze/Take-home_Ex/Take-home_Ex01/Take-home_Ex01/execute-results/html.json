{
  "hash": "77d4b7140827a44ca8274e687fedb124",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1: Demographic structures and distribution of Singapore in 2024\"\nformat: html\nauthor: \"Belinda Lim\"\ndate: May 1, 2025\ndate-modified: \"last-modified\"\neditor: source\nexecute:\n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n# **1 Introduction**\n\n## **1.1 Overview**\n\nAccording to [World Health Organisation](https://www.who.int/data/gho/indicator-metadata-registry/imr-details/1119), economically dependent population is defined as the sum of the population under 15 years of age plus the population 65 years of age and over, for a given country, territory, or geographic area, at a specific point in time.\n\nEconomically productive population is defined as the population between 15 and 64 years of age, for the same country, territory, or geographic area, at the same specific point in time.\n\nWith this definition, we aim to conduct an exploratory data analysis on the demographic structures and distribution of Singapore in 2024, focusing on the three groups of population, to understand their characteristics for better policy making.\n\n# **2 Data and Data Pre-processing**\n\n## **2.1 Data Source**\n\nThe data for Singapore Residents by Planning Area / Subzone, Single Year of Age and Sex, June 2024 are downloaded from [Department of Statistics, Singapore (DOS)](https://www.singstat.gov.sg/find-data/search-by-theme/population/geographic-distribution/latest-data). The dataset comprise 6 variables and 60,424 records.\n\n## **2.2 Loading data and libraries**\n\n::: callout-note\n### Note\n\nIt is assumed that you already have [**pacman**](https://cran.r-project.org/web/packages/pacman/index.html) package installed. If not, please go ahead install pacman first. The code chunk below uses p_load() of pacman package to check if tidyverse packages are installed in the computer. If they are, then they will be launched into R.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, patchwork, scales, sf, readr, ggplot2, viridis, plotly)\n```\n:::\n\n\n\nWe import Demographic_data.csv into R environment by using [*read_csv()*](https://readr.tidyverse.org/reference/read_delim.html) function of [**readr**](https://readr.tidyverse.org/) package. **readr** is one of the tidyverse package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_data <- read_csv(\"data/Demographic_data.csv\", show_col_types = FALSE)\n```\n:::\n\n\n\nUnder Age, there is also a category \"90_and_Over\". For data visualisation, the category is converted to the numeric number \"90\" instead. The following codes will convert and ensure that all figures under \"Age\" and \"Pop\" are numeric.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_data <- pop_data %>%\n  mutate(\n    Age = if_else(Age == \"90_and_Over\", \"90\", Age), \n    Age = as.numeric(Age),                           \n    Pop = as.numeric(Pop)                            \n  )\n```\n:::\n\n\n\n# **3 Exploratory Data Analysis and Insights**\n\n## **3.1 Singapore Population Age Pyramid and Life Expectancy**\n\n### 3.1.1 Data preparation and Visualisation\n\nFirst we will bin the ages into 5-year blocks for greater visibility by age groups.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prepare age group bins\npop_data <- pop_data %>%\nmutate(AgeGroup = cut(Age, breaks = c(seq(0, 90, by = 5), Inf),\n                        labels = c(paste(seq(0,85,5), seq(4,89,5), sep=\"-\"), \"90+\"),\n                        right = FALSE))\n```\n:::\n\n\n\nThe population data is grouped by age group and sex and convert the male population such that it is on the left.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Age Pyramid Data\nage_pyramid <- pop_data %>%\n  group_by(AgeGroup, Sex) %>%\n  summarise(Population = sum(Pop), .groups = 'drop') %>%\n  mutate(Population = ifelse(Sex == \"Males\", -Population, Population))\n```\n:::\n\n\n\nThe Age Pyramid data is plotted:\n\n::::: panel-tabset\n### The plot\n\n\n\n::: {.cell}\n\n:::\n\n\n\n### The code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot Age Pyramid\npyramid_plot <- ggplot(age_pyramid, aes(x = Population, y = AgeGroup, fill = Sex)) +\n  geom_bar(stat=\"identity\") +\n  scale_x_continuous(\n  labels = function(x) scales::comma(abs(x)),\n  breaks = scales::pretty_breaks()) +\n  labs(title=\"Age Pyramid\", x=\"Population\", y=\"Age Group\") +\n  scale_fill_manual(values = c(\"Males\" = \"lightblue\", \"Females\" = \"pink\")) +\n  theme_minimal() +\n  theme(legend.position=\"bottom\") +\n  theme(plot.title = element_text(hjust = 0.5))  \n```\n:::\n\n\n\nTo compare the life expectancy of males and female for each age group, it is recommended to compute proportions for comparison by age groups due to the different total population numbers in each age group. This helps to standardise the data for equitable comparisons of life expectancy between males and females.\n\nThe formula used for males and females respectively is as follows:\n\n**Proportion for each age group = Population in each age group / Total population for each sex**\n\nFor example,\n\n| Age Group | Population    | Proportion                  |\n|-----------|---------------|-----------------------------|\n| 0-4       | 87,420        | 87,420 / 2,038,810 = 0.043  |\n| 5-9       | 103,540       | 103,540 / 2,038,810 = 0.051 |\n| ...       | ...           | ...                         |\n| ...       | ...           | ...                         |\n| **Total** | **2,038,810** | **1**                       |\n\nThe code below executes the computation above.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Life Expectancy Data (Proportional)\nlife_expectancy <- pop_data %>%\n  group_by(AgeGroup, Sex) %>%\n  summarise(Population = sum(Pop), .groups = 'drop') %>%\n  group_by(Sex) %>%\n  mutate(Proportion = Population / sum(Population))\n```\n:::\n\n\n\n:::: panel-tabset\n### The plot\n\n\n\n::: {.cell}\n\n:::\n\n\n\n### The code\n\n\n\n::: {.cell}\n\n:::\n\n\n\nThe 2 plots are combined using the code below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlegend <- cowplot::get_legend(\n  pyramid_plot + theme(legend.position = \"bottom\")\n)\n\n# Wrap legend as a patchwork element\nlegend_patch <- wrap_elements(full = legend)\n\n# Title as a patchwork plot (can use plot_annotation + blank)\ntitle_patch <- plot_annotation(\n  title = \"Age Pyramid and Life Expectancy Comparison\",\n  theme = theme(plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"))\n)\n\n# Combine everything\ncombined_plot <- pyramid_plot + life_expectancy_plot +\n  plot_layout(ncol = 2, widths = c(1, 2), guides = \"collect\") +\n  plot_annotation(\n    title = \"Age Pyramid and Life Expectancy Comparison\",\n    theme = theme(\n      plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\")\n    )\n  ) & \n  theme(\n    legend.position = \"bottom\",\n    legend.box = \"horizontal\",\n    legend.justification = \"center\",\n    legend.box.just = \"center\",\n    legend.text = element_text(size = 8),\n    legend.title = element_text(size = 9)\n  )\n\ncombined_plot\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n### 3.1.2 Insights\n\nSingapore's population age pyramid can be described as a [constrictive pyramid](https://populationeducation.org/what-are-different-types-population-pyramids/), which is typical for countries with higher levels of social and economic developments. There are low birth and mortality rates, contributing to an ageing population. The largest population groups belong to ages 30-64, and this results in a reduced economically productive population over time.\n\nWhen we examine the population's life expectancy, we see that females have longer life expectancy than males especially from age 70 onwards. However, the life expectancy of females and males both show sharp decline from age 65 onwards, which suggest higher mortality rates for these groups.\n\nWith ageing population, it is important to focus on preventive healthcare measures for a healthier population. This enables a later retirement age for older Singaporeans to contribute economically. Given the lower life expectancy of males, more studies can be done to understand their morbidity causes to improve their lifespan.\n\n## **3.2 Population demographics by Planning Areas**\n\nThere are [55 Planning Areas](https://eservice.ura.gov.sg/maps/?service=MP#) (PA) designated by URA where each planning area is served by a town centre and several neighbourhood commercial/shopping centres. Each area is supported by smaller subzones (SZ), which are usually centred on a focal point such as neighbourhood centre or activity node.\n\nUsing data visualisation, we can identify the top 10 PA with the highest percentage of population aged 65 and above.\n\n### 3.1.1 Data preparation and Visualisation\n\nThe following codes are used to:\n\n-   Compute Total population per Planning Area\n\n-   Compute Total Population aged 65 and above by Planning Areas\n\n-   Merge both data and compute percentage of Population aged 65 and above by Planning Areas\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_total <- pop_data %>%\n  group_by(PA) %>%\n  summarise(TotalPop = sum(Pop, na.rm = TRUE))\n\npop_65plus <- pop_data %>%\n  filter(Age >= 65) %>%\n  group_by(PA) %>%\n  summarise(Pop65Plus = sum(Pop, na.rm = TRUE))\n\npop_summary <- left_join(pop_total, pop_65plus, by = \"PA\") %>%\n  mutate(\n    Pop65Plus = replace_na(Pop65Plus, 0),\n    PctOver65 = Pop65Plus / TotalPop * 100,\n    PctOver65 = ifelse(is.nan(PctOver65), NA, round(PctOver65, 1))\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_data <- pop_summary %>%\n  arrange(desc(Pop65Plus)) %>%\n  slice_head(n = 20) %>%\n  mutate(\n    PA = factor(PA, levels = rev(PA)),  # reversed so top is highest\n    LabelPop = format(Pop65Plus, big.mark = \",\"),\n    LabelPct = paste0(round(PctOver65, 1), \"%\")\n  )\n\n# Step 2: Compute medians\nmedian_pop <- median(plot_data$Pop65Plus, na.rm = TRUE)\nmedian_pct <- median(plot_data$PctOver65, na.rm = TRUE)\n\n# Step 3: Population chart\npop_plot <- ggplot(plot_data, aes(x = Pop65Plus, y = PA)) +\n  geom_col(fill = \"#006400\")+\n  geom_text(aes(label = LabelPop), hjust = -0.2, size = 2.8) +\n  geom_vline(xintercept = median_pop, color = \"red\", linetype = \"dashed\", linewidth = 0.8) +\nannotate(\"text\", x = median_pop, y = 21.2, label = \"Median\", color = \"red\", size = 3, vjust = 1) +\n  labs(title = \"Total Population Aged 65+\", x = \"Population\", y = NULL) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 12, face = \"bold\"),\n    axis.text.y = element_text(size = 10),\n    plot.margin = margin(5, 30, 5, 5)  # add right margin space\n  ) +\n  scale_x_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.2)))\n\n# Step 4: Percentage chart\npct_plot <- ggplot(plot_data, aes(x = PctOver65, y = PA)) +\n  geom_col(fill = \"#b6e2d3\") +\n  geom_text(aes(label = LabelPct), hjust = -0.2, size = 2.8) +\n  geom_vline(xintercept = median_pct, color = \"red\", linetype = \"dashed\", linewidth = 0.8) +\n annotate(\"text\", x = median_pct, y = 21.2, label = \"Median\", color = \"red\", size = 3, vjust = 1)+\n  labs(title = \"Percentage Population Aged 65+\", x = \"% Aged 65+\", y = NULL) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 12, face = \"bold\"),\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    plot.margin = margin(5, 5, 5, 5)  # optional\n  ) +\n  scale_x_continuous(labels = scales::label_percent(scale = 1), expand = expansion(mult = c(0, 0.2)))\n\n# Step 5: Combine with patchwork\nfinal_chart <- pop_plot + pct_plot +\n  plot_layout(ncol = 2, widths = c(1.1, 1)) +\n  plot_annotation(\n    title = \"Elderly Population and Proportion by Top 20 Planning Area\",\n    theme = theme(\n      plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n      plot.subtitle = element_text(hjust = 0.5, size = 11)\n    )\n  )\n\n# Step 6: Show plot\nfinal_chart\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n### 3.1.3 Extra visualisation beyond the scope of Take-Home Exercise\n\nWe download the Singapore's map shapefile from [URA's Master Plan 2014 Planning Area Boundary](https://data.gov.sg/collections/1701/view).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsg_map <- st_read(\"data/Map/MP14_PLNG_AREA_WEB_PL.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `MP14_PLNG_AREA_WEB_PL' from data source \n  `C:\\Users\\Belinda\\OneDrive - Singapore Management University\\Desktop\\Visual Analytics\\belindalim\\ISSS608-VAA\\Take-home_Ex\\Take-home_Ex01\\data\\Map\\MP14_PLNG_AREA_WEB_PL.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 55 features and 12 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n```\n\n\n:::\n:::\n\n\n\nFormat and Join the computed percentage of Population aged 65 and above by Planning Areas to the map.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsg_map <- sg_map %>%\n  mutate(PA = toupper(trimws(PLN_AREA_N)))\n\npop_summary <- pop_summary %>%\n  mutate(PA = toupper(trimws(PA)))\n\nsg_map_joined <- sg_map %>%\n  left_join(pop_summary, by = \"PA\")\n```\n:::\n\n\n\nCreating the plot\n\n::: panel-tabset\n### The plot\n\n31b8e172-b470-440e-83d8-e6b185028602:dAB5AHAAZQA6AE8AUQBCAGoAQQBHAEkAQQBOAHcAQQA1AEEARwBVAEEATgBnAEIAagBBAEMAMABBAE8AQQBBADQAQQBEAGcAQQBaAEEAQQB0AEEARABRAEEAWQBRAEEAdwBBAEcAVQBBAEwAUQBBADUAQQBHAE0AQQBPAFEAQgBpAEEAQwAwAEEAWgBnAEIAbQBBAEQAWQBBAE4AdwBCAGoAQQBHAFEAQQBOAEEAQQB3AEEARABRAEEAWgBRAEEAMgBBAEQAQQBBAAoAcABvAHMAaQB0AGkAbwBuADoATQBRAEEAMwBBAEQAQQBBAE4AZwBBAHgAQQBBAD0APQAKAHAAcgBlAGYAaQB4ADoACgBzAG8AdQByAGMAZQA6AFkAQQBCAGcAQQBHAEEAQQBlAHcAQgA3AEEASABJAEEATABBAEEAZwBBAEcAVQBBAFkAdwBCAG8AQQBHADgAQQBJAEEAQQA5AEEAQwBBAEEAUgBnAEIAQgBBAEUAdwBBAFUAdwBCAEYAQQBIADAAQQBmAFEAQQBLAEEASABBAEEASQBBAEEAOABBAEMAMABBAEkAQQBCAG4AQQBHAGMAQQBjAEEAQgBzAEEARwA4AEEAZABBAEEAbwBBAEgATQBBAFoAdwBCAGYAQQBHADAAQQBZAFEAQgB3AEEARgA4AEEAYQBnAEIAdgBBAEcAawBBAGIAZwBCAGwAQQBHAFEAQQBLAFEAQQBnAEEAQwBzAEEAQwBnAEEAZwBBAEMAQQBBAFoAdwBCAGwAQQBHADgAQQBiAFEAQgBmAEEASABNAEEAWgBnAEEAbwBBAEcARQBBAFoAUQBCAHoAQQBDAGcAQQBDAGcAQQBnAEEAQwBBAEEASQBBAEEAZwBBAEcAWQBBAGEAUQBCAHMAQQBHAHcAQQBJAEEAQQA5AEEAQwBBAEEAVQBBAEIAagBBAEgAUQBBAFQAdwBCADIAQQBHAFUAQQBjAGcAQQAyAEEARABVAEEATABBAEEASwBBAEMAQQBBAEkAQQBBAGcAQQBDAEEAQQBkAEEAQgBsAEEASABnAEEAZABBAEEAZwBBAEQAMABBAEkAQQBCAHcAQQBHAEUAQQBjAHcAQgAwAEEARwBVAEEATQBBAEEAbwBBAEMASQBBAFUAQQBCAHMAQQBHAEUAQQBiAGcAQgB1AEEARwBrAEEAYgBnAEIAbgBBAEMAQQBBAFEAUQBCAHkAQQBHAFUAQQBZAFEAQQA2AEEAQwBBAEEASQBnAEEAcwBBAEMAQQBBAFUAQQBCAEIAQQBDAHcAQQBJAEEAQQBpAEEARgB3AEEAYgBnAEIAQgBBAEcAYwBBAFoAUQBBAGcAQQBEAFkAQQBOAFEAQQByAEEAQwBBAEEAVQBBAEIAdgBBAEgAQQBBAGQAUQBCAHMAQQBHAEUAQQBkAEEAQgBwAEEARwA4AEEAYgBnAEEANgBBAEMAQQBBAEkAZwBBAHMAQQBDAEEAQQBVAEEAQgBqAEEASABRAEEAVAB3AEIAMgBBAEcAVQBBAGMAZwBBADIAQQBEAFUAQQBMAEEAQQBnAEEAQwBJAEEASgBRAEEAaQBBAEMAawBBAEMAZwBBAGcAQQBDAEEAQQBLAFEAQQBzAEEAQwBBAEEAWQB3AEIAdgBBAEcAdwBBAGIAdwBCAHkAQQBDAEEAQQBQAFEAQQBnAEEAQwBJAEEAZAB3AEIAbwBBAEcAawBBAGQAQQBCAGwAQQBDAEkAQQBMAEEAQQBnAEEARwB3AEEAYQBRAEIAdQBBAEcAVQBBAGQAdwBCAHAAQQBHAFEAQQBkAEEAQgBvAEEAQwBBAEEAUABRAEEAZwBBAEQAQQBBAEwAZwBBAHoAQQBDAGsAQQBJAEEAQQByAEEAQQBvAEEASQBBAEEAZwBBAEgATQBBAFkAdwBCAGgAQQBHAHcAQQBaAFEAQgBmAEEARwBZAEEAYQBRAEIAcwBBAEcAdwBBAFgAdwBCAG4AQQBIAEkAQQBZAFEAQgBrAEEARwBrAEEAWgBRAEIAdQBBAEgAUQBBAEsAQQBBAEsAQQBDAEEAQQBJAEEAQQBnAEEAQwBBAEEAYgBBAEIAdgBBAEgAYwBBAEkAQQBBADkAQQBDAEEAQQBJAGcAQQBqAEEARwBZAEEAWgBnAEIAbABBAEQAQQBBAFkAZwBBAHkAQQBDAEkAQQBMAEEAQQBnAEEAQwBBAEEASQBBAEEAagBBAEMAQQBBAFkAZwBCAHkAQQBHAGsAQQBaAHcAQgBvAEEASABRAEEAWgBRAEIAeQBBAEMAQQBBAGIAQQBCAHAAQQBHAGMAQQBhAEEAQgAwAEEAQwBBAEEAYgB3AEIAeQBBAEcARQBBAGIAZwBCAG4AQQBHAFUAQQBDAGcAQQBnAEEAQwBBAEEASQBBAEEAZwBBAEcAZwBBAGEAUQBCAG4AQQBHAGcAQQBJAEEAQQA5AEEAQwBBAEEASQBnAEEAagBBAEcASQBBAE0AdwBBAHcAQQBEAEEAQQBNAEEAQQB3AEEAQwBJAEEATABBAEEAZwBBAEMAQQBBAEkAdwBBAGcAQQBIAE0AQQBkAEEAQgB5AEEARwA4AEEAYgBnAEIAbgBBAEMAQQBBAFoAQQBCAGgAQQBIAEkAQQBhAHcAQQBnAEEASABJAEEAWgBRAEIAawBBAEMAMABBAGIAdwBCAHkAQQBHAEUAQQBiAGcAQgBuAEEARwBVAEEAQwBnAEEAZwBBAEMAQQBBAEkAQQBBAGcAQQBHADQAQQBZAFEAQQB1AEEASABZAEEAWQBRAEIAcwBBAEgAVQBBAFoAUQBBAGcAQQBEADAAQQBJAEEAQQBpAEEARwBjAEEAYwBnAEIAbABBAEgAawBBAE8AUQBBAHcAQQBDAEkAQQBLAFEAQQBnAEEAQwBzAEEAQwBnAEEAZwBBAEMAQQBBAGIAQQBCAGgAQQBHAEkAQQBjAHcAQQBvAEEAQQBvAEEASQBBAEEAZwBBAEMAQQBBAEkAQQBCADAAQQBHAGsAQQBkAEEAQgBzAEEARwBVAEEASQBBAEEAOQBBAEMAQQBBAEkAZwBCAFMAQQBHAFUAQQBjAHcAQgBwAEEARwBRAEEAWgBRAEIAdQBBAEgAUQBBAGMAdwBBAGcAQQBFAEUAQQBaAHcAQgBsAEEARwBRAEEASQBBAEEAMgBBAEQAVQBBAEsAdwBBAGcAQQBHAEkAQQBlAFEAQQBnAEEARgBBAEEAYgBBAEIAaABBAEcANABBAGIAZwBCAHAAQQBHADQAQQBaAHcAQQBnAEEARQBFAEEAYwBnAEIAbABBAEcARQBBAEkAQQBBAG8AQQBEAEkAQQBNAEEAQQB5AEEARABRAEEASwBRAEEAaQBBAEMAdwBBAEMAZwBBAGcAQQBDAEEAQQBJAEEAQQBnAEEARwBZAEEAYQBRAEIAcwBBAEcAdwBBAEkAQQBBADkAQQBDAEEAQQBJAGcAQQBsAEEAQwBBAEEAUQBRAEIAbgBBAEcAVQBBAFoAQQBBAGcAQQBEAFkAQQBOAFEAQQByAEEAQwBJAEEAQwBnAEEAZwBBAEMAQQBBAEsAUQBBAGcAQQBDAHMAQQBDAGcAQQBnAEEAQwBBAEEAZABBAEIAbwBBAEcAVQBBAGIAUQBCAGwAQQBGADgAQQBkAGcAQgB2AEEARwBrAEEAWgBBAEEAbwBBAEMAawBBAEkAQQBBAHIAQQBDAEEAQQBkAEEAQgBvAEEARwBVAEEAYgBRAEIAbABBAEMAZwBBAGMAQQBCAGgAQQBHADQAQQBaAFEAQgBzAEEAQwA0AEEAWQBnAEIAdgBBAEgASQBBAFoAQQBCAGwAQQBIAEkAQQBJAEEAQQA5AEEAQwBBAEEAWgBRAEIAcwBBAEcAVQBBAGIAUQBCAGwAQQBHADQAQQBkAEEAQgBmAEEARwBJAEEAYgBBAEIAaABBAEcANABBAGEAdwBBAG8AQQBDAGsAQQBLAFEAQQBnAEEAQQBvAEEAQwBnAEIAbgBBAEcAYwBBAGMAQQBCAHMAQQBHADgAQQBkAEEAQgBzAEEASABrAEEASwBBAEIAdwBBAEMAdwBBAEkAQQBCADAAQQBHADgAQQBiAHcAQgBzAEEASABRAEEAYQBRAEIAdwBBAEMAQQBBAFAAUQBBAGcAQQBDAEkAQQBkAEEAQgBsAEEASABnAEEAZABBAEEAaQBBAEMAawBBAEMAZwBBAEsAQQBHAEEAQQBZAEEAQgBnAEEAQQA9AD0ACgBzAHUAZgBmAGkAeAA6AA==:31b8e172-b470-440e-83d8-e6b185028602 \\### The code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- ggplot(sg_map_joined) +\n  geom_sf(aes(\n    fill = PctOver65,\n    text = paste0(\"Planning Area: \", PA, \"\\nAge 65+ Population: \", PctOver65, \"%\")\n  ), color = \"white\", linewidth = 0.3) +\n  scale_fill_gradient(\n    low = \"#ffe0b2\",   # brighter light orange\n    high = \"#b30000\",  # strong dark red-orange\n    na.value = \"grey90\") +\n  labs(\n    title = \"Residents Aged 65+ by Planning Area (2024)\",\n    fill = \"% Aged 65+\"\n  ) +\n  theme_void() + theme(panel.border = element_blank()) \n\nggplotly(p, tooltip = \"text\")\n```\n:::\n\n\n:::\n\n## **3.3 Insights 1**\n\nAccording to [World Health Organisation](https://www.who.int/data/gho/indicator-metadata-registry/imr-details/1119), economically dependent population is defined as the sum of the population under 15 years of age plus the population 65 years of age and over, for a given country, territory, or geographic area, at a specific point in time.\n\nEconomically productive population is defined as the population between 15 and 64 years of age, for the same country, territory, or geographic area, at the same specific point in time.\n\nDependency ratio measures the average number of economically dependent population per 100 economically productive population, for a given country, territory, or geographic area, at a specific point in time.\n\nCreate and sum up the population numbers based on the above definition\n\n-   Those Age_DR \\< 15 are \"Dependent_0_14\"\n\n-   Those Age_DR \\>= 65 are \"Dependent_65_plus\"\n\n-   Those Age_DR \\>= 15 & Age_DR \\<= 64 are \"Productive\"\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_data <- read_csv(\"data/Demographic_data.csv\") %>%\n  mutate(\n    Age_DR = if_else(Age == \"90_and_Over\", \"90\", as.character(Age)),\n    Age_DR = as.numeric(Age_DR),\n    Pop_DR = as.numeric(Pop),\n    AgeGroup_DR = case_when(\n      Age_DR < 15 ~ \"Dependent_0_14\",\n      Age_DR >= 65 ~ \"Dependent_65_plus\",\n      Age_DR >= 15 & Age_DR <= 64 ~ \"Productive\",\n      TRUE ~ NA_character_\n    )\n  )\n```\n:::\n\n\n\nSummarise by PA and AgeGroup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_summary_DR <- pop_data %>%\n  filter(!is.na(AgeGroup_DR)) %>%\n  group_by(PA, AgeGroup_DR) %>%\n  summarise(Pop_DR = sum(Pop_DR, na.rm = TRUE), .groups = \"drop\")\n```\n:::\n\n\n\nPivot Wide and Calculate Dependency Ratio\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_wide_DR <- pop_summary_DR %>%\n  pivot_wider(names_from = AgeGroup_DR, values_from = Pop_DR, values_fill = 0) %>%\n  mutate(\n    Dependent_DR = Dependent_0_14 + Dependent_65_plus,\n    Productive_DR = Productive,\n    DependencyRatio = round((Dependent_DR / Productive_DR) * 100, 1)\n  ) %>%\n  filter(Productive_DR > 0)  # prevent divide-by-zero\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pop_wide_DR, aes(x = DependencyRatio, y = reorder(PA, DependencyRatio), fill = DependencyRatio)) +\n  geom_col() +\n  scale_fill_gradientn(\n    colours = c(\"#ccece6\", \"#66c2a4\", \"#238b45\", \"#00441b\"),  # deeper green gradient\n    limits = c(min(pop_wide_DR$DependencyRatio), max(pop_wide_DR$DependencyRatio))\n  ) +\n  labs(\n    title = \"Dependency Ratio by Planning Area\",\n    x = \"Dependency Ratio (%)\",\n    y = \"Planning Area\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    panel.grid = element_blank(),        # remove gridlines\n    legend.position = \"right\",           # optional: move legend\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.text.y = element_text(size = 10)\n  ) +\n  coord_cartesian(clip = \"off\")  # avoids label cut-off when length increases\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n# **4 Conclusion**\n\n## **4.1 XXXX**\n\n# **5 References**\n\n## **4.1 XXXX**\n::::\n:::::\n\n:::::\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}